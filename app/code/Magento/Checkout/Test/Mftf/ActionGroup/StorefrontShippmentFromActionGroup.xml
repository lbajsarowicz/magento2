<?xml version="1.0" encoding="UTF-8"?>
<!--
 /**
  * Copyright Â© Magento, Inc. All rights reserved.
  * See COPYING.txt for license details.
  */
-->

<actionGroups xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:noNamespaceSchemaLocation="urn:magento:mftf:Test/etc/actionGroupSchema.xsd">
    <!--Fill shipment form for free shipping-->
    <actionGroup name="ShipmentFormFreeShippingActionGroup">
        <annotations>
            <description>Fills in the Customer details for the 'Shipping Address' section of the Storefront Checkout page. Selects 'Free Shipping'. Clicks on Next. Validates that the URL is present and correct.</description>
        </annotations>

        <fillField selector="{{CheckoutShippingSection.email}}" userInput="{{CustomerEntityOne.email}}" stepKey="setCustomerEmail"/>
        <fillField selector="{{CheckoutShippingSection.firstName}}" userInput="{{CustomerEntityOne.firstname}}" stepKey="setCustomerFirstName"/>
        <fillField selector="{{CheckoutShippingSection.lastName}}" userInput="{{CustomerEntityOne.lastname}}" stepKey="setCustomerLastName"/>
        <fillField selector="{{CheckoutShippingSection.street}}" userInput="{{CustomerAddressSimple.street}}" stepKey="setCustomerStreetAddress"/>
        <fillField selector="{{CheckoutShippingSection.city}}" userInput="{{CustomerAddressSimple.city}}" stepKey="setCustomerCity"/>
        <fillField selector="{{CheckoutShippingSection.postcode}}" userInput="{{CustomerAddressSimple.postcode}}" stepKey="setCustomerZipCode"/>
        <fillField selector="{{CheckoutShippingSection.telephone}}" userInput="{{CustomerAddressSimple.telephone}}" stepKey="setCustomerPhoneNumber"/>
        <click selector="{{CheckoutShippingSection.region}}" stepKey="clickToSetState"/>
        <click selector="{{CheckoutShippingSection.state}}" stepKey="clickToChooseState"/>
        <see userInput="$0.00	Free	Free Shipping" selector="{{CheckoutShippingMethodsSection.shippingMethodRowByName('Free Shipping')}}" stepKey="seeShippingMethod" after="clickToChooseState"/>
        <click selector="{{CheckoutShippingMethodsSection.checkShippingMethodByName('Free Shipping')}}" stepKey="selectFlatShippingMethod" after="seeShippingMethod"/>
        <waitForLoadingMaskToDisappear stepKey="waitForLoadingMask" after="selectFlatShippingMethod"/>
        <click selector="{{CheckoutShippingSection.next}}" stepKey="clickToSaveShippingInfo"/>
        <waitForPageLoad time="5" stepKey="waitForReviewAndPaymentsPageIsLoaded"/>
        <seeInCurrentUrl url="payment" stepKey="reviewAndPaymentIsShown"/>
    </actionGroup>
</actionGroups>
